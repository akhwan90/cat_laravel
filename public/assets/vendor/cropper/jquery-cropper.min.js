/*!
 * Cropper.js v1.5.12
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2021-06-12T08:00:17.411Z
 */ !function(b,a){"object"==typeof exports&&"undefined"!=typeof module?module.exports=a():"function"==typeof define&&define.amd?define(a):(b="undefined"!=typeof globalThis?globalThis:b||self).Cropper=a()}(this,function(){"use strict";function i(c,d){var a=Object.keys(c);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(c);d&&(b=b.filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable})),a.push.apply(a,b)}return a}function j(c){for(var a=1;a<arguments.length;a++){var b=null!=arguments[a]?arguments[a]:{};a%2?i(Object(b),!0).forEach(function(a){m(c,a,b[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(b)):i(Object(b)).forEach(function(a){Object.defineProperty(c,a,Object.getOwnPropertyDescriptor(b,a))})}return c}function k(a){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function l(d,c){for(var b=0;b<c.length;b++){var a=c[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}}function m(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function n(a){return o(a)||p(a)||q(a)||s()}function o(a){if(Array.isArray(a))return r(a)}function p(a){if("undefined"!=typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"])return Array.from(a)}function q(a,c){if(a){if("string"==typeof a)return r(a,c);var b=Object.prototype.toString.call(a).slice(8,-1);if("Object"===b&&a.constructor&&(b=a.constructor.name),"Map"===b||"Set"===b)return Array.from(a);if("Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return r(a,c)}}function r(c,a){(null==a||a>c.length)&&(a=c.length);for(var b=0,d=new Array(a);b<a;b++)d[b]=c[b];return d}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c="undefined"!=typeof window&& void 0!==window.document,b=c?window:{},d=!!c&&!!b.document.documentElement&&"ontouchstart"in b.document.documentElement,e=!!c&&"PointerEvent"in b,a="cropper",t="crop",u="move",v="zoom",w="e",x="w",y="s",z="n",A="".concat(a,"-crop"),B="".concat(a,"-disabled"),C="".concat(a,"-hidden"),D="".concat(a,"-hide"),E="".concat(a,"-invisible"),F="".concat(a,"-modal"),G="".concat(a,"-move"),H="".concat(a,"Action"),I="".concat(a,"Preview"),g="crop",J="move",K="none",L="crop",M="cropend",N="cropmove",O="cropstart",P="dblclick",Q=e?"pointerdown":d?"touchstart":"mousedown",R=e?"pointermove":d?"touchmove":"mousemove",S=e?"pointerup pointercancel":d?"touchend touchcancel":"mouseup",T="ready",U="resize",V="wheel",W="zoom",X="image/jpeg",Y=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,Z=/^data:/,$=/^data:image\/jpeg;base64,/,_=/^img|canvas$/i,aa={viewMode:0,dragMode:g,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},ab=Number.isNaN||b.isNaN;function ac(a){return"number"==typeof a&&!ab(a)}var ad=function(a){return a>0&&a<1/0};function ae(a){return void 0===a}function af(a){return"object"===k(a)&&null!==a}var ag=Object.prototype.hasOwnProperty;function ah(a){if(!af(a))return!1;try{var b=a.constructor,c=b.prototype;return b&&c&&ag.call(c,"isPrototypeOf")}catch(d){return!1}}function ai(a){return"function"==typeof a}var aj=Array.prototype.slice;function ak(a){return Array.from?Array.from(a):aj.call(a)}function al(a,b){return a&&ai(b)&&(Array.isArray(a)||ac(a.length)?ak(a).forEach(function(c,d){b.call(a,c,d,a)}):af(a)&&Object.keys(a).forEach(function(c){b.call(a,a[c],c,a)})),a}var h=Object.assign||function(d){for(var b=arguments.length,c=new Array(b>1?b-1:0),a=1;a<b;a++)c[a-1]=arguments[a];return af(d)&&c.length>0&&c.forEach(function(a){af(a)&&Object.keys(a).forEach(function(b){d[b]=a[b]})}),d},am=/\.\d*(?:0|9){12}\d*$/;function an(a){var b=arguments.length>1&& void 0!==arguments[1]?arguments[1]:1e11;return am.test(a)?Math.round(a*b)/b:a}var ao=/^width|height|left|top|marginLeft|marginTop$/;function ap(a,b){var c=a.style;al(b,function(a,b){ao.test(b)&&ac(a)&&(a="".concat(a,"px")),c[b]=a})}function aq(a,b){if(b){if(ac(a.length)){al(a,function(a){aq(a,b)});return}if(a.classList){a.classList.add(b);return}var c=a.className.trim();c?0>c.indexOf(b)&&(a.className="".concat(c," ").concat(b)):a.className=b}}function ar(a,b){if(b){if(ac(a.length)){al(a,function(a){ar(a,b)});return}if(a.classList){a.classList.remove(b);return}a.className.indexOf(b)>=0&&(a.className=a.className.replace(b,""))}}function as(a,b,c){if(b){if(ac(a.length)){al(a,function(a){as(a,b,c)});return}c?aq(a,b):ar(a,b)}}var at=/([a-z\d])([A-Z])/g;function au(a){return a.replace(at,"$1-$2").toLowerCase()}function av(a,b){return af(a[b])?a[b]:a.dataset?a.dataset[b]:a.getAttribute("data-".concat(au(b)))}function aw(a,c,b){af(b)?a[c]=b:a.dataset?a.dataset[c]=b:a.setAttribute("data-".concat(au(c)),b)}var ax=/\s\s*/,ay=function(){var e=!1;if(c){var f=!1,a=function(){},d=Object.defineProperty({},"once",{get:function(){return e=!0,f},set:function(a){f=a}});b.addEventListener("test",a,d),b.removeEventListener("test",a,d)}return e}();function az(c,a,b){var d=arguments.length>3&& void 0!==arguments[3]?arguments[3]:{},e=b;a.trim().split(ax).forEach(function(f){if(!ay){var a=c.listeners;a&&a[f]&&a[f][b]&&(e=a[f][b],delete a[f][b],0===Object.keys(a[f]).length&&delete a[f],0===Object.keys(a).length&&delete c.listeners)}c.removeEventListener(f,e,d)})}function aA(c,a,b){var d=arguments.length>3&& void 0!==arguments[3]?arguments[3]:{},e=b;a.trim().split(ax).forEach(function(a){if(d.once&&!ay){var g=c.listeners,f=void 0===g?{}:g;e=function(){delete f[a][b],c.removeEventListener(a,e,d);for(var h=arguments.length,i=new Array(h),g=0;g<h;g++)i[g]=arguments[g];b.apply(c,i)},f[a]||(f[a]={}),f[a][b]&&c.removeEventListener(a,f[a][b],d),f[a][b]=e,c.listeners=f}c.addEventListener(a,e,d)})}function aB(d,b,c){var a;return ai(Event)&&ai(CustomEvent)?a=new CustomEvent(b,{detail:c,bubbles:!0,cancelable:!0}):(a=document.createEvent("CustomEvent")).initCustomEvent(b,!0,!0,c),d.dispatchEvent(a)}function aC(b){var a=b.getBoundingClientRect();return{left:a.left+(window.pageXOffset-document.documentElement.clientLeft),top:a.top+(window.pageYOffset-document.documentElement.clientTop)}}var aD=b.location,aE=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function aF(b){var a=b.match(aE);return null!==a&&(a[1]!==aD.protocol||a[2]!==aD.hostname||a[3]!==aD.port)}function aG(a){var b="timestamp=".concat(new Date().getTime());return a+(-1===a.indexOf("?")?"?":"&")+b}function aH(b){var c=b.rotate,d=b.scaleX,e=b.scaleY,f=b.translateX,g=b.translateY,a=[];ac(f)&&0!==f&&a.push("translateX(".concat(f,"px)")),ac(g)&&0!==g&&a.push("translateY(".concat(g,"px)")),ac(c)&&0!==c&&a.push("rotate(".concat(c,"deg)")),ac(d)&&1!==d&&a.push("scaleX(".concat(d,")")),ac(e)&&1!==e&&a.push("scaleY(".concat(e,")"));var h=a.length?a.join(" "):"none";return{WebkitTransform:h,msTransform:h,transform:h}}function aI(a,e){var b=a.pageX,c=a.pageY,d={endX:b,endY:c};return e?d:j({startX:b,startY:c},d)}function aJ(d){var c=d.aspectRatio,b=d.height,a=d.width,e=arguments.length>1&& void 0!==arguments[1]?arguments[1]:"contain",f=ad(a),g=ad(b);if(f&&g){var h=b*c;"contain"===e&&h>a||"cover"===e&&h<a?b=a/c:a=b*c}else f?b=a/c:g&&(a=b*c);return{width:a,height:b}}var aK=String.fromCharCode,aL=/^data:.*,/,aM=b.Cropper,f=function(){var c,d,e;function f(a){var b=arguments.length>1&& void 0!==arguments[1]?arguments[1]:{};if(!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,f),!a||!_.test(a.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=a,this.options=h({},aa,ah(b)&&b),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return c=f,d=[{key:"init",value:function(){var b,c=this.element,d=c.tagName.toLowerCase();if(!c[a]){if(c[a]=this,"img"===d){if(this.isImg=!0,b=c.getAttribute("src")||"",this.originalUrl=b,!b)return;b=c.src}else"canvas"===d&&window.HTMLCanvasElement&&(b=c.toDataURL());this.load(b)}}},{key:"load",value:function(b){var j,f,g,d,h,k=this;if(b){this.url=b,this.imageData={};var i=this.element,c=this.options;if(c.rotatable||c.scalable||(c.checkOrientation=!1),!c.checkOrientation||!window.ArrayBuffer){this.clone();return}if(Z.test(b)){$.test(b)?this.read((f=b.replace(aL,""),g=atob(f),d=new ArrayBuffer(g.length),h=new Uint8Array(d),al(h,function(b,a){h[a]=g.charCodeAt(a)}),d)):this.clone();return}var a=new XMLHttpRequest,e=this.clone.bind(this);this.reloading=!0,this.xhr=a,a.onabort=e,a.onerror=e,a.ontimeout=e,a.onprogress=function(){a.getResponseHeader("content-type")!==X&&a.abort()},a.onload=function(){k.read(a.response)},a.onloadend=function(){k.reloading=!1,k.xhr=null},c.checkCrossOrigin&&aF(b)&&i.crossOrigin&&(b=aG(b)),a.open("GET",b,!0),a.responseType="arraybuffer",a.withCredentials="use-credentials"===i.crossOrigin,a.send()}}},{key:"read",value:function(c){var d=this.options,a=this.imageData,e=function(k){var a=new DataView(k);try{if(255===a.getUint8(0)&&216===a.getUint8(1))for(var l=a.byteLength,b=2;b+1<l;){if(255===a.getUint8(b)&&225===a.getUint8(b+1)){o=b;break}b+=1}if(o){var m=o+4,d=o+10;if("Exif"===function(e,b,c){var d="";c+=b;for(var a=b;a<c;a+=1)d+=aK(e.getUint8(a));return d}(a,m,4)){var h=a.getUint16(d);if(((e=18761===h)||19789===h)&&42===a.getUint16(d+2,e)){var i=a.getUint32(d+4,e);i>=8&&(j=d+i)}}}if(j){var g,e,o,j,c,f,n=a.getUint16(j,e);for(f=0;f<n;f+=1)if(c=j+12*f+2,274===a.getUint16(c,e)){c+=8,g=a.getUint16(c,e),a.setUint16(c,1,e);break}}}catch(p){g=1}return g}(c),f=0,g=1,h=1;if(e>1){this.url=function(c,d){for(var b=[],a=new Uint8Array(c);a.length>0;)b.push(aK.apply(null,ak(a.subarray(0,8192)))),a=a.subarray(8192);return"data:".concat(d,";base64,").concat(btoa(b.join("")))}(c,X);var b=function(d){var a=0,b=1,c=1;switch(d){case 2:b=-1;break;case 3:a=-180;break;case 4:c=-1;break;case 5:a=90,c=-1;break;case 6:a=90;break;case 7:a=90,b=-1;break;case 8:a=-90}return{rotate:a,scaleX:b,scaleY:c}}(e);f=b.rotate,g=b.scaleX,h=b.scaleY}d.rotatable&&(a.rotate=f),d.scalable&&(a.scaleX=g,a.scaleY=h),this.clone()}},{key:"clone",value:function(){var c=this.element,d=this.url,b=c.crossOrigin,e=d;this.options.checkCrossOrigin&&aF(d)&&(b||(b="anonymous"),e=aG(d)),this.crossOrigin=b,this.crossOriginUrl=e;var a=document.createElement("img");b&&(a.crossOrigin=b),a.src=e||d,a.alt=c.alt||"The image to crop",this.image=a,a.onload=this.start.bind(this),a.onerror=this.stop.bind(this),aq(a,D),c.parentNode.insertBefore(a,c.nextSibling)}},{key:"start",value:function(){var g=this,a=this.image;a.onload=null,a.onerror=null,this.sizing=!0;var d=b.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(b.navigator.userAgent),e=function(a,b){h(g.imageData,{naturalWidth:a,naturalHeight:b,aspectRatio:a/b}),g.initialImageData=h({},g.imageData),g.sizing=!1,g.sized=!0,g.build()};if(a.naturalWidth&&!d){e(a.naturalWidth,a.naturalHeight);return}var c=document.createElement("img"),f=document.body||document.documentElement;this.sizingImage=c,c.onload=function(){e(c.width,c.height),d||f.removeChild(c)},c.src=a.src,d||(c.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",f.appendChild(c))}},{key:"stop",value:function(){var a=this.image;a.onload=null,a.onerror=null,a.parentNode.removeChild(a),this.image=null}},{key:"build",value:function(){if(this.sized&&!this.ready){var e=this.element,b=this.options,g=this.image,h=e.parentNode,i=document.createElement("div");i.innerHTML='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>';var c=i.querySelector(".".concat(a,"-container")),j=c.querySelector(".".concat(a,"-canvas")),k=c.querySelector(".".concat(a,"-drag-box")),d=c.querySelector(".".concat(a,"-crop-box")),f=d.querySelector(".".concat(a,"-face"));this.container=h,this.cropper=c,this.canvas=j,this.dragBox=k,this.cropBox=d,this.viewBox=c.querySelector(".".concat(a,"-view-box")),this.face=f,j.appendChild(g),aq(e,C),h.insertBefore(c,e.nextSibling),this.isImg||ar(g,D),this.initPreview(),this.bind(),b.initialAspectRatio=Math.max(0,b.initialAspectRatio)||NaN,b.aspectRatio=Math.max(0,b.aspectRatio)||NaN,b.viewMode=Math.max(0,Math.min(3,Math.round(b.viewMode)))||0,aq(d,C),b.guides||aq(d.getElementsByClassName("".concat(a,"-dashed")),C),b.center||aq(d.getElementsByClassName("".concat(a,"-center")),C),b.background&&aq(c,"".concat(a,"-bg")),b.highlight||aq(f,E),b.cropBoxMovable&&(aq(f,G),aw(f,H,"all")),b.cropBoxResizable||(aq(d.getElementsByClassName("".concat(a,"-line")),C),aq(d.getElementsByClassName("".concat(a,"-point")),C)),this.render(),this.ready=!0,this.setDragMode(b.dragMode),b.autoCrop&&this.crop(),this.setData(b.data),ai(b.ready)&&aA(e,T,b.ready,{once:!0}),aB(e,T)}}},{key:"unbuild",value:function(){this.ready&&(this.ready=!1,this.unbind(),this.resetPreview(),this.cropper.parentNode.removeChild(this.cropper),ar(this.element,C))}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],e=[{key:"noConflict",value:function(){return window.Cropper=aM,f}},{key:"setDefaults",value:function(a){h(aa,ah(a)&&a)}}],d&&l(c.prototype,d),e&&l(c,e),f}();return h(f.prototype,{render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var c=this.element,d=this.options,e=this.container,a=this.cropper,f=Number(d.minContainerWidth),g=Number(d.minContainerHeight);aq(a,C),ar(c,C);var b={width:Math.max(e.offsetWidth,f>=0?f:200),height:Math.max(e.offsetHeight,g>=0?g:100)};this.containerData=b,ap(a,{width:b.width,height:b.height}),aq(c,C),ar(a,C)},initCanvas:function(){var b=this.containerData,d=this.imageData,e=this.options.viewMode,i=Math.abs(d.rotate)%180==90,j=i?d.naturalHeight:d.naturalWidth,k=i?d.naturalWidth:d.naturalHeight,c=j/k,f=b.width,g=b.height;b.height*c>b.width?3===e?f=b.height*c:g=b.width/c:3===e?g=b.width/c:f=b.height*c;var a={aspectRatio:c,naturalWidth:j,naturalHeight:k,width:f,height:g};this.canvasData=a,this.limited=1===e||2===e,this.limitCanvas(!0,!0),a.width=Math.min(Math.max(a.width,a.minWidth),a.maxWidth),a.height=Math.min(Math.max(a.height,a.minHeight),a.maxHeight),a.left=(b.width-a.width)/2,a.top=(b.height-a.height)/2,a.oldLeft=a.left,a.oldTop=a.top,this.initialCanvasData=h({},a)},limitCanvas:function(m,n){var k=this.options,e=this.containerData,a=this.canvasData,d=this.cropBoxData,g=k.viewMode,f=a.aspectRatio,h=this.cropped&&d;if(m){var b=Number(k.minCanvasWidth)||0,c=Number(k.minCanvasHeight)||0;g>1?(b=Math.max(b,e.width),c=Math.max(c,e.height),3===g&&(c*f>b?b=c*f:c=b/f)):g>0&&(b?b=Math.max(b,h?d.width:0):c?c=Math.max(c,h?d.height:0):h&&(b=d.width,c=d.height,c*f>b?b=c*f:c=b/f));var l=aJ({aspectRatio:f,width:b,height:c});b=l.width,c=l.height,a.minWidth=b,a.minHeight=c,a.maxWidth=1/0,a.maxHeight=1/0}if(n){if(g>(h?0:1)){var i=e.width-a.width,j=e.height-a.height;a.minLeft=Math.min(0,i),a.minTop=Math.min(0,j),a.maxLeft=Math.max(0,i),a.maxTop=Math.max(0,j),h&&this.limited&&(a.minLeft=Math.min(d.left,d.left+(d.width-a.width)),a.minTop=Math.min(d.top,d.top+(d.height-a.height)),a.maxLeft=d.left,a.maxTop=d.top,2===g&&(a.width>=e.width&&(a.minLeft=Math.min(0,i),a.maxLeft=Math.max(0,i)),a.height>=e.height&&(a.minTop=Math.min(0,j),a.maxTop=Math.max(0,j))))}else a.minLeft=-a.width,a.minTop=-a.height,a.maxLeft=e.width,a.maxTop=e.height}},renderCanvas:function(i,j){var a=this.canvasData,b=this.imageData;if(j){var e=function(b){var c=b.width,d=b.height,a=b.degree;if(90==(a=Math.abs(a)%180))return{width:d,height:c};var e=a%90*Math.PI/180,f=Math.sin(e),g=Math.cos(e),h=c*g+d*f,i=c*f+d*g;return a>90?{width:i,height:h}:{width:h,height:i}}({width:b.naturalWidth*Math.abs(b.scaleX||1),height:b.naturalHeight*Math.abs(b.scaleY||1),degree:b.rotate||0}),c=e.width,d=e.height,f=a.width*(c/a.naturalWidth),g=a.height*(d/a.naturalHeight);a.left-=(f-a.width)/2,a.top-=(g-a.height)/2,a.width=f,a.height=g,a.aspectRatio=c/d,a.naturalWidth=c,a.naturalHeight=d,this.limitCanvas(!0,!1)}(a.width>a.maxWidth||a.width<a.minWidth)&&(a.left=a.oldLeft),(a.height>a.maxHeight||a.height<a.minHeight)&&(a.top=a.oldTop),a.width=Math.min(Math.max(a.width,a.minWidth),a.maxWidth),a.height=Math.min(Math.max(a.height,a.minHeight),a.maxHeight),this.limitCanvas(!1,!0),a.left=Math.min(Math.max(a.left,a.minLeft),a.maxLeft),a.top=Math.min(Math.max(a.top,a.minTop),a.maxTop),a.oldLeft=a.left,a.oldTop=a.top,ap(this.canvas,h({width:a.width,height:a.height},aH({translateX:a.left,translateY:a.top}))),this.renderImage(i),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(e){var b=this.canvasData,a=this.imageData,c=a.naturalWidth*(b.width/b.naturalWidth),d=a.naturalHeight*(b.height/b.naturalHeight);h(a,{width:c,height:d,left:(b.width-c)/2,top:(b.height-d)/2}),ap(this.image,h({width:a.width,height:a.height},aH(h({translateX:a.left,translateY:a.top},a)))),e&&this.output()},initCropBox:function(){var d=this.options,b=this.canvasData,c=d.aspectRatio||d.initialAspectRatio,e=Number(d.autoCropArea)||.8,a={width:b.width,height:b.height};c&&(b.height*c>b.width?a.height=a.width/c:a.width=a.height*c),this.cropBoxData=a,this.limitCropBox(!0,!0),a.width=Math.min(Math.max(a.width,a.minWidth),a.maxWidth),a.height=Math.min(Math.max(a.height,a.minHeight),a.maxHeight),a.width=Math.max(a.minWidth,a.width*e),a.height=Math.max(a.minHeight,a.height*e),a.left=b.left+(b.width-a.width)/2,a.top=b.top+(b.height-a.height)/2,a.oldLeft=a.left,a.oldTop=a.top,this.initialCropBoxData=h({},a)},limitCropBox:function(k,l){var i=this.options,c=this.containerData,b=this.canvasData,a=this.cropBoxData,j=this.limited,f=i.aspectRatio;if(k){var d=Number(i.minCropBoxWidth)||0,e=Number(i.minCropBoxHeight)||0,g=j?Math.min(c.width,b.width,b.width+b.left,c.width-b.left):c.width,h=j?Math.min(c.height,b.height,b.height+b.top,c.height-b.top):c.height;d=Math.min(d,c.width),e=Math.min(e,c.height),f&&(d&&e?e*f>d?e=d/f:d=e*f:d?e=d/f:e&&(d=e*f),h*f>g?h=g/f:g=h*f),a.minWidth=Math.min(d,g),a.minHeight=Math.min(e,h),a.maxWidth=g,a.maxHeight=h}l&&(j?(a.minLeft=Math.max(0,b.left),a.minTop=Math.max(0,b.top),a.maxLeft=Math.min(c.width,b.left+b.width)-a.width,a.maxTop=Math.min(c.height,b.top+b.height)-a.height):(a.minLeft=0,a.minTop=0,a.maxLeft=c.width-a.width,a.maxTop=c.height-a.height))},renderCropBox:function(){var b=this.options,c=this.containerData,a=this.cropBoxData;(a.width>a.maxWidth||a.width<a.minWidth)&&(a.left=a.oldLeft),(a.height>a.maxHeight||a.height<a.minHeight)&&(a.top=a.oldTop),a.width=Math.min(Math.max(a.width,a.minWidth),a.maxWidth),a.height=Math.min(Math.max(a.height,a.minHeight),a.maxHeight),this.limitCropBox(!1,!0),a.left=Math.min(Math.max(a.left,a.minLeft),a.maxLeft),a.top=Math.min(Math.max(a.top,a.minTop),a.maxTop),a.oldLeft=a.left,a.oldTop=a.top,b.movable&&b.cropBoxMovable&&aw(this.face,H,a.width>=c.width&&a.height>=c.height?u:"all"),ap(this.cropBox,h({width:a.width,height:a.height},aH({translateX:a.left,translateY:a.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),aB(this.element,L,this.getData())}},{initPreview:function(){var e=this.element,d=this.crossOrigin,a=this.options.preview,f=d?this.crossOriginUrl:this.url,g=e.alt||"The image to preview",b=document.createElement("img");if(d&&(b.crossOrigin=d),b.src=f,b.alt=g,this.viewBox.appendChild(b),this.viewBoxImage=b,a){var c=a;"string"==typeof a?c=e.ownerDocument.querySelectorAll(a):a.querySelector&&(c=[a]),this.previews=c,al(c,function(a){var b=document.createElement("img");aw(a,I,{width:a.offsetWidth,height:a.offsetHeight,html:a.innerHTML}),d&&(b.crossOrigin=d),b.src=f,b.alt=g,b.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',a.innerHTML="",a.appendChild(b)})}},resetPreview:function(){al(this.previews,function(a){var b=av(a,I);ap(a,{width:b.width,height:b.height}),a.innerHTML=b.html,function(a,b){if(af(a[b]))try{delete a[b]}catch(c){a[b]=void 0}else if(a.dataset)try{delete a.dataset[b]}catch(d){a.dataset[b]=void 0}else a.removeAttribute("data-".concat(au(b)))}(a,I)})},preview:function(){var a=this.imageData,c=this.canvasData,b=this.cropBoxData,i=b.width,j=b.height,d=a.width,e=a.height,f=b.left-c.left-a.left,g=b.top-c.top-a.top;this.cropped&&!this.disabled&&(ap(this.viewBoxImage,h({width:d,height:e},aH(h({translateX:-f,translateY:-g},a)))),al(this.previews,function(l){var m=av(l,I),n=m.width,c=m.height,o=n,k=c,b=1;i&&(k=j*(b=n/i)),j&&k>c&&(o=i*(b=c/j),k=c),ap(l,{width:o,height:k}),ap(l.getElementsByTagName("img")[0],h({width:d*b,height:e*b},aH(h({translateX:-f*b,translateY:-g*b},a))))}))}},{bind:function(){var b=this.element,a=this.options,c=this.cropper;ai(a.cropstart)&&aA(b,O,a.cropstart),ai(a.cropmove)&&aA(b,N,a.cropmove),ai(a.cropend)&&aA(b,M,a.cropend),ai(a.crop)&&aA(b,L,a.crop),ai(a.zoom)&&aA(b,W,a.zoom),aA(c,Q,this.onCropStart=this.cropStart.bind(this)),a.zoomable&&a.zoomOnWheel&&aA(c,V,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),a.toggleDragModeOnDblclick&&aA(c,P,this.onDblclick=this.dblclick.bind(this)),aA(b.ownerDocument,R,this.onCropMove=this.cropMove.bind(this)),aA(b.ownerDocument,S,this.onCropEnd=this.cropEnd.bind(this)),a.responsive&&aA(window,U,this.onResize=this.resize.bind(this))},unbind:function(){var b=this.element,a=this.options,c=this.cropper;ai(a.cropstart)&&az(b,O,a.cropstart),ai(a.cropmove)&&az(b,N,a.cropmove),ai(a.cropend)&&az(b,M,a.cropend),ai(a.crop)&&az(b,L,a.crop),ai(a.zoom)&&az(b,W,a.zoom),az(c,Q,this.onCropStart),a.zoomable&&a.zoomOnWheel&&az(c,V,this.onWheel,{passive:!1,capture:!0}),a.toggleDragModeOnDblclick&&az(c,P,this.onDblclick),az(b.ownerDocument,R,this.onCropMove),az(b.ownerDocument,S,this.onCropEnd),a.responsive&&az(window,U,this.onResize)}},{resize:function(){if(!this.disabled){var a,b,c=this.options,d=this.container,e=this.containerData,f=d.offsetWidth/e.width,g=d.offsetHeight/e.height,h=Math.abs(f-1)>Math.abs(g-1)?f:g;1!==h&&(c.restore&&(a=this.getCanvasData(),b=this.getCropBoxData()),this.render(),c.restore&&(this.setCanvasData(al(a,function(b,c){a[c]=b*h})),this.setCropBoxData(al(b,function(a,c){b[c]=a*h}))))}},dblclick:function(){var a,b;this.disabled||this.options.dragMode===K||this.setDragMode((a=this.dragBox,b=A,a.classList?a.classList.contains(b):a.className.indexOf(b)> -1)?J:g)},wheel:function(a){var d=this,c=Number(this.options.wheelZoomRatio)||.1,b=1;!this.disabled&&(a.preventDefault(),this.wheeling||(this.wheeling=!0,setTimeout(function(){d.wheeling=!1},50),a.deltaY?b=a.deltaY>0?1:-1:a.wheelDelta?b=-a.wheelDelta/120:a.detail&&(b=a.detail>0?1:-1),this.zoom(-b*c,a)))},cropStart:function(a){var b,c=a.buttons,d=a.button;if(!(this.disabled||("mousedown"===a.type||"pointerdown"===a.type&&"mouse"===a.pointerType)&&(ac(c)&&1!==c||ac(d)&&0!==d||a.ctrlKey))){var e=this.options,f=this.pointers;a.changedTouches?al(a.changedTouches,function(a){f[a.identifier]=aI(a)}):f[a.pointerId||0]=aI(a),b=Object.keys(f).length>1&&e.zoomable&&e.zoomOnTouch?v:av(a.target,H),Y.test(b)&& !1!==aB(this.element,O,{originalEvent:a,action:b})&&(a.preventDefault(),this.action=b,this.cropping=!1,b===t&&(this.cropping=!0,aq(this.dragBox,F)))}},cropMove:function(a){var b=this.action;if(!this.disabled&&b){var c=this.pointers;a.preventDefault(),!1!==aB(this.element,N,{originalEvent:a,action:b})&&(a.changedTouches?al(a.changedTouches,function(a){h(c[a.identifier]||{},aI(a,!0))}):h(c[a.pointerId||0]||{},aI(a,!0)),this.change(a))}},cropEnd:function(a){if(!this.disabled){var b=this.action,c=this.pointers;a.changedTouches?al(a.changedTouches,function(a){delete c[a.identifier]}):delete c[a.pointerId||0],b&&(a.preventDefault(),Object.keys(c).length||(this.action=""),this.cropping&&(this.cropping=!1,as(this.dragBox,F,this.cropped&&this.options.modal)),aB(this.element,M,{originalEvent:a,action:b}))}}},{change:function(E){var F,H,G,D,I=this.options,r=this.canvasData,A=this.containerData,h=this.cropBoxData,B=this.pointers,g=this.action,f=I.aspectRatio,e=h.left,d=h.top,b=h.width,c=h.height,q=e+b,n=d+c,o=0,l=0,p=A.width,m=A.height,i=!0;!f&&E.shiftKey&&(f=b&&c?b/c:1),this.limited&&(o=h.minLeft,l=h.minTop,p=o+Math.min(A.width,r.width,r.left+r.width),m=l+Math.min(A.height,r.height,r.top+r.height));var s=B[Object.keys(B)[0]],a={x:s.endX-s.startX,y:s.endY-s.startY},k=function(b){switch(b){case w:q+a.x>p&&(a.x=p-q);break;case x:e+a.x<o&&(a.x=o-e);break;case z:d+a.y<l&&(a.y=l-d);break;case y:n+a.y>m&&(a.y=m-n)}};switch(g){case"all":e+=a.x,d+=a.y;break;case w:if(a.x>=0&&(q>=p||f&&(d<=l||n>=m))){i=!1;break}k(w),(b+=a.x)<0&&(g=x,e-=b=-b),f&&(c=b/f,d+=(h.height-c)/2);break;case z:if(a.y<=0&&(d<=l||f&&(e<=o||q>=p))){i=!1;break}k(z),c-=a.y,d+=a.y,c<0&&(g=y,d-=c=-c),f&&(b=c*f,e+=(h.width-b)/2);break;case x:if(a.x<=0&&(e<=o||f&&(d<=l||n>=m))){i=!1;break}k(x),b-=a.x,e+=a.x,b<0&&(g=w,e-=b=-b),f&&(c=b/f,d+=(h.height-c)/2);break;case y:if(a.y>=0&&(n>=m||f&&(e<=o||q>=p))){i=!1;break}k(y),(c+=a.y)<0&&(g=z,d-=c=-c),f&&(b=c*f,e+=(h.width-b)/2);break;case"ne":if(f){if(a.y<=0&&(d<=l||q>=p)){i=!1;break}k(z),c-=a.y,d+=a.y,b=c*f}else k(z),k(w),a.x>=0?q<p?b+=a.x:a.y<=0&&d<=l&&(i=!1):b+=a.x,a.y<=0?d>l&&(c-=a.y,d+=a.y):(c-=a.y,d+=a.y);b<0&&c<0?(g="sw",b=-b,d-=c=-c,e-=b):b<0?(g="nw",e-=b=-b):c<0&&(g="se",d-=c=-c);break;case"nw":if(f){if(a.y<=0&&(d<=l||e<=o)){i=!1;break}k(z),c-=a.y,d+=a.y,b=c*f,e+=h.width-b}else k(z),k(x),a.x<=0?e>o?(b-=a.x,e+=a.x):a.y<=0&&d<=l&&(i=!1):(b-=a.x,e+=a.x),a.y<=0?d>l&&(c-=a.y,d+=a.y):(c-=a.y,d+=a.y);b<0&&c<0?(g="se",b=-b,d-=c=-c,e-=b):b<0?(g="ne",e-=b=-b):c<0&&(g="sw",d-=c=-c);break;case"sw":if(f){if(a.x<=0&&(e<=o||n>=m)){i=!1;break}k(x),b-=a.x,e+=a.x,c=b/f}else k(y),k(x),a.x<=0?e>o?(b-=a.x,e+=a.x):a.y>=0&&n>=m&&(i=!1):(b-=a.x,e+=a.x),a.y>=0?n<m&&(c+=a.y):c+=a.y;b<0&&c<0?(g="ne",b=-b,d-=c=-c,e-=b):b<0?(g="se",e-=b=-b):c<0&&(g="nw",d-=c=-c);break;case"se":if(f){if(a.x>=0&&(q>=p||n>=m)){i=!1;break}k(w),b+=a.x,c=b/f}else k(y),k(w),a.x>=0?q<p?b+=a.x:a.y>=0&&n>=m&&(i=!1):b+=a.x,a.y>=0?n<m&&(c+=a.y):c+=a.y;b<0&&c<0?(g="nw",b=-b,d-=c=-c,e-=b):b<0?(g="sw",e-=b=-b):c<0&&(g="ne",d-=c=-c);break;case u:this.move(a.x,a.y),i=!1;break;case v:this.zoom((H=j({},F=B),G=0,al(F,function(b,a){delete H[a],al(H,function(a){var c=Math.abs(b.startX-a.startX),d=Math.abs(b.startY-a.startY),e=Math.abs(b.endX-a.endX),f=Math.abs(b.endY-a.endY),g=Math.sqrt(c*c+d*d),h=(Math.sqrt(e*e+f*f)-g)/g;Math.abs(h)>Math.abs(G)&&(G=h)})}),G),E),i=!1;break;case t:if(!a.x||!a.y){i=!1;break}D=aC(this.cropper),e=s.startX-D.left,d=s.startY-D.top,b=h.minWidth,c=h.minHeight,a.x>0?g=a.y>0?"se":"ne":a.x<0&&(e-=b,g=a.y>0?"sw":"nw"),a.y<0&&(d-=c),!this.cropped&&(ar(this.cropBox,C),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))}i&&(h.width=b,h.height=c,h.left=e,h.top=d,this.action=g,this.renderCropBox()),al(B,function(a){a.startX=a.endX,a.startY=a.endY})}},{crop:function(){return!this.ready||this.cropped||this.disabled||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&aq(this.dragBox,F),ar(this.cropBox,C),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=h({},this.initialImageData),this.canvasData=h({},this.initialCanvasData),this.cropBoxData=h({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(h(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),ar(this.dragBox,F),aq(this.cropBox,C)),this},replace:function(a){var b=arguments.length>1&& void 0!==arguments[1]&&arguments[1];return!this.disabled&&a&&(this.isImg&&(this.element.src=a),b?(this.url=a,this.image.src=a,this.ready&&(this.viewBoxImage.src=a,al(this.previews,function(b){b.getElementsByTagName("img")[0].src=a}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(a))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,ar(this.cropper,B)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,aq(this.cropper,B)),this},destroy:function(){var b=this.element;return b[a]&&(b[a]=void 0,this.isImg&&this.replaced&&(b.src=this.originalUrl),this.uncreate()),this},move:function(a){var b=arguments.length>1&& void 0!==arguments[1]?arguments[1]:a,c=this.canvasData,d=c.left,e=c.top;return this.moveTo(ae(a)?a:d+Number(a),ae(b)?b:e+Number(b))},moveTo:function(a){var b=arguments.length>1&& void 0!==arguments[1]?arguments[1]:a,d=this.canvasData,c=!1;return a=Number(a),b=Number(b),this.ready&&!this.disabled&&this.options.movable&&(ac(a)&&(d.left=a,c=!0),ac(b)&&(d.top=b,c=!0),c&&this.renderCanvas(!0)),this},zoom:function(a,c){var b=this.canvasData;return a=(a=Number(a))<0?1/(1-a):1+a,this.zoomTo(b.width*a/b.naturalWidth,null,c)},zoomTo:function(c,d,f){var p=this.options,a=this.canvasData,b=a.width,e=a.height,m=a.naturalWidth,q=a.naturalHeight;if((c=Number(c))>=0&&this.ready&&!this.disabled&&p.zoomable){var g=m*c,h=q*c;if(!1===aB(this.element,W,{ratio:c,oldRatio:b/m,originalEvent:f}))return this;if(f){var r,i,j,k,l=this.pointers,n=aC(this.cropper),o=l&&Object.keys(l).length?(i=0,j=0,k=0,al(l,function(a){var b=a.startX,c=a.startY;i+=b,j+=c,k+=1}),i/=k,j/=k,{pageX:i,pageY:j}):{pageX:f.pageX,pageY:f.pageY};a.left-=(g-b)*((o.pageX-n.left-a.left)/b),a.top-=(h-e)*((o.pageY-n.top-a.top)/e)}else ah(d)&&ac(d.x)&&ac(d.y)?(a.left-=(g-b)*((d.x-a.left)/b),a.top-=(h-e)*((d.y-a.top)/e)):(a.left-=(g-b)/2,a.top-=(h-e)/2);a.width=g,a.height=h,this.renderCanvas(!0)}return this},rotate:function(a){return this.rotateTo((this.imageData.rotate||0)+Number(a))},rotateTo:function(a){return ac(a=Number(a))&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=a%360,this.renderCanvas(!0,!0)),this},scaleX:function(b){var a=this.imageData.scaleY;return this.scale(b,ac(a)?a:1)},scaleY:function(b){var a=this.imageData.scaleX;return this.scale(ac(a)?a:1,b)},scale:function(a){var b=arguments.length>1&& void 0!==arguments[1]?arguments[1]:a,d=this.imageData,c=!1;return a=Number(a),b=Number(b),this.ready&&!this.disabled&&this.options.scalable&&(ac(a)&&(d.scaleX=a,c=!0),ac(b)&&(d.scaleY=b,c=!0),c&&this.renderCanvas(!0,!0)),this},getData:function(){var a,f=arguments.length>0&& void 0!==arguments[0]&&arguments[0],d=this.options,b=this.imageData,e=this.canvasData,c=this.cropBoxData;if(this.ready&&this.cropped){a={x:c.left-e.left,y:c.top-e.top,width:c.width,height:c.height};var i=b.width/b.naturalWidth;if(al(a,function(b,c){a[c]=b/i}),f){var g=Math.round(a.y+a.height),h=Math.round(a.x+a.width);a.x=Math.round(a.x),a.y=Math.round(a.y),a.width=h-a.x,a.height=g-a.y}}else a={x:0,y:0,width:0,height:0};return d.rotatable&&(a.rotate=b.rotate||0),d.scalable&&(a.scaleX=b.scaleX||1,a.scaleY=b.scaleY||1),a},setData:function(a){var f=this.options,b=this.imageData,g=this.canvasData,c={};if(this.ready&&!this.disabled&&ah(a)){var d=!1;f.rotatable&&ac(a.rotate)&&a.rotate!==b.rotate&&(b.rotate=a.rotate,d=!0),f.scalable&&(ac(a.scaleX)&&a.scaleX!==b.scaleX&&(b.scaleX=a.scaleX,d=!0),ac(a.scaleY)&&a.scaleY!==b.scaleY&&(b.scaleY=a.scaleY,d=!0)),d&&this.renderCanvas(!0,!0);var e=b.width/b.naturalWidth;ac(a.x)&&(c.left=a.x*e+g.left),ac(a.y)&&(c.top=a.y*e+g.top),ac(a.width)&&(c.width=a.width*e),ac(a.height)&&(c.height=a.height*e),this.setCropBoxData(c)}return this},getContainerData:function(){return this.ready?h({},this.containerData):{}},getImageData:function(){return this.sized?h({},this.imageData):{}},getCanvasData:function(){var b=this.canvasData,a={};return this.ready&&al(["left","top","width","height","naturalWidth","naturalHeight"],function(c){a[c]=b[c]}),a},setCanvasData:function(a){var b=this.canvasData,c=b.aspectRatio;return this.ready&&!this.disabled&&ah(a)&&(ac(a.left)&&(b.left=a.left),ac(a.top)&&(b.top=a.top),ac(a.width)?(b.width=a.width,b.height=a.width/c):ac(a.height)&&(b.height=a.height,b.width=a.height*c),this.renderCanvas(!0)),this},getCropBoxData:function(){var b,a=this.cropBoxData;return this.ready&&this.cropped&&(b={left:a.left,top:a.top,width:a.width,height:a.height}),b||{}},setCropBoxData:function(a){var d,e,b=this.cropBoxData,c=this.options.aspectRatio;return this.ready&&this.cropped&&!this.disabled&&ah(a)&&(ac(a.left)&&(b.left=a.left),ac(a.top)&&(b.top=a.top),ac(a.width)&&a.width!==b.width&&(d=!0,b.width=a.width),ac(a.height)&&a.height!==b.height&&(e=!0,b.height=a.height),c&&(d?b.height=b.width/c:e&&(b.width=b.height*c)),this.renderCropBox()),this},getCroppedCanvas:function(){var l,r,s,t,m,o,b=arguments.length>0&& void 0!==arguments[0]?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var $,f,u,e,D,_,aa,E,F,G,H,ab,ac,I,J,K,L,M,N,O,P,Q,R,S,p,a,T,U,v,w,V,W,X,Y,ad=this.canvasData,g=($=this.image,f=this.imageData,u=ad,e=b,D=f.aspectRatio,_=f.naturalWidth,aa=f.naturalHeight,E=f.rotate,F=f.scaleX,G=f.scaleY,H=u.aspectRatio,ab=u.naturalWidth,ac=u.naturalHeight,I=e.fillColor,J=e.imageSmoothingEnabled,K=e.imageSmoothingQuality,L=e.maxWidth,M=void 0===L?1/0:L,N=e.maxHeight,O=void 0===N?1/0:N,P=e.minWidth,Q=void 0===P?0:P,R=e.minHeight,S=void 0===R?0:R,p=document.createElement("canvas"),a=p.getContext("2d"),T=aJ({aspectRatio:H,width:M,height:O}),U=aJ({aspectRatio:H,width:Q,height:S},"cover"),v=Math.min(T.width,Math.max(U.width,ab)),w=Math.min(T.height,Math.max(U.height,ac)),V=aJ({aspectRatio:D,width:M,height:O}),W=aJ({aspectRatio:D,width:Q,height:S},"cover"),X=Math.min(V.width,Math.max(W.width,_)),Y=Math.min(V.height,Math.max(W.height,aa)),p.width=an(v),p.height=an(w),a.fillStyle=void 0===I?"transparent":I,a.fillRect(0,0,v,w),a.save(),a.translate(v/2,w/2),a.rotate((void 0===E?0:E)*Math.PI/180),a.scale(void 0===F?1:F,void 0===G?1:G),a.imageSmoothingEnabled=void 0===J||J,a.imageSmoothingQuality=void 0===K?"low":K,a.drawImage.apply(a,[$].concat(n([-X/2,-Y/2,X,Y].map(function(a){return Math.floor(an(a))})))),a.restore(),p);if(!this.cropped)return g;var x=this.getData(),ae=x.x,af=x.y,h=x.width,j=x.height,i=g.width/Math.floor(ad.naturalWidth);1!==i&&(ae*=i,af*=i,h*=i,j*=i);var Z=h/j,ag=aJ({aspectRatio:Z,width:b.maxWidth||1/0,height:b.maxHeight||1/0}),ah=aJ({aspectRatio:Z,width:b.minWidth||0,height:b.minHeight||0},"cover"),ai=aJ({aspectRatio:Z,width:b.width||(1!==i?g.width:h),height:b.height||(1!==i?g.height:j)}),q=ai.width,y=ai.height;q=Math.min(ag.width,Math.max(ah.width,q)),y=Math.min(ag.height,Math.max(ah.height,y));var z=document.createElement("canvas"),k=z.getContext("2d");z.width=an(q),z.height=an(y),k.fillStyle=b.fillColor||"transparent",k.fillRect(0,0,q,y);var aj=b.imageSmoothingEnabled,ak=b.imageSmoothingQuality;k.imageSmoothingEnabled=void 0===aj||aj,ak&&(k.imageSmoothingQuality=ak);var A=g.width,B=g.height,c=ae,d=af;c<= -h||c>A?(c=0,l=0,s=0,m=0):c<=0?(s=-c,m=l=Math.min(A,h+(c=0))):c<=A&&(s=0,m=l=Math.min(h,A-c)),l<=0||d<= -j||d>B?(d=0,r=0,t=0,o=0):d<=0?(t=-d,o=r=Math.min(B,j+(d=0))):d<=B&&(t=0,o=r=Math.min(j,B-d));var al=[c,d,l,r];if(m>0&&o>0){var C=q/h;al.push(s*C,t*C,m*C,o*C)}return k.drawImage.apply(k,[g].concat(n(al.map(function(a){return Math.floor(an(a))})))),z},setAspectRatio:function(a){var b=this.options;return!this.disabled&&!ae(a)&&(b.aspectRatio=Math.max(0,a)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(a){var b=this.options,c=this.dragBox,d=this.face;if(this.ready&&!this.disabled){var e=a===g,f=b.movable&&a===J;a=e||f?a:K,b.dragMode=a,aw(c,H,a),as(c,A,e),as(c,G,f),b.cropBoxMovable||(aw(d,H,a),as(d,A,e),as(d,G,f))}return this}}),f})